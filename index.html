<html>
  <head>
    <title>Site of Marie-Christin</title>
    <link rel="stylesheet" href="https://bootswatch.com/4/sketchy/bootstrap.css">
  </head>
  <body>
    <!--  <{tag} {attribut}>{content}</{tag}> -->
    <h1>Ferien-Countdown</h1>
    <p id="ferienZähler">Loading dates...</p>
    <h3 id="ferienArt">bis zu den Sommerferien!</h3>
    <select id="ferienAuswahl">
      <option value="winterferien-2022-TH">Winterferien</option>
      <option value="osterferien-2022-TH">Osterferien</option>
      <option value="pfingstferien-2022-TH">Pfingstferien</option>
      <option value="sommerferien-2022-TH">Sommerferien</option>
      <option value="herbstferien-2022-TH">Herbstferien</option>
      <option value="weihnachtsferien-2022-TH">Weihnachtsferien</option>
    </select>
    <br>
    <br>
    <br>
    <table border="">
      <thead>
        <tr>
          <td>
            <p>Ferien</p>
          </td>
          <td>
            <p>Beginn</p>
          </td>
          <td>
            <p>Ende</p>
          </td>
        </tr>
        </thead>
        <tbody>
        <tr>
        <td>
          <p>Sommerferien</p>
        </td>
        <td>
          <p>23.07.2021</p>
        </td>
        <td>
          <p>01.09.2021</p>
        </td>
      </tr>
      <tr>
      <td>
        <p>Osterferien</p>
      </td>
      <td>
        <p>11.04.2021</p>
      </td>
      <td>
        <p>28.04.2021</p>
      </td>
    </tr>
    <tr>
    <td>
      <p>Herbstferien</p>
    </td>
    <td>
      <p>08.10.2021</p>
    </td>
    <td>
      <p>20.10.2021</p>
    </td>
    </tr>
     <tbody>
    </table>
    <a href="https://github.com/lgh-ag/lghag.de" >Unsere Website</a>
    
    <script src="https://cdn.jsdelivr.net/npm/underscore@latest/underscore-umd-min.js"></script>

    <script>
      var json = "";
      var obj = null;
      var ferienDate = null;

     function reqListener () {
      json = this.responseText;
      obj = JSON.parse(json);
      
      selectChange();
      getSecounds();  
    }

var oReq = new XMLHttpRequest();
oReq.addEventListener("load", reqListener);
oReq.open("GET", "https://lgh-ag-cors.herokuapp.com/https://ferien-api.de/api/v1/holidays/TH/2022");
oReq.setRequestHeader("x-requested-with", "lghag.de");
oReq.send();

      function getSecounds() {
        var currentDate = Date.now();

        var milli = ferienDate - currentDate;
        var abgezogen = 0;

        var wochen = Math.floor(milli /1000 / 60 / 60 / 24 / 7);
        abgezogen = abgezogen + wochen * 1000 * 60 * 60 * 24 * 7;

        var tage = Math.floor((milli - abgezogen) / 1000 / 60 / 60 / 24);
        abgezogen = abgezogen + tage * 1000 * 60 * 60 * 24; 
        
        var stunden = Math.floor((milli - abgezogen) / 1000 / 60 / 60);
        abgezogen = abgezogen + stunden * 1000 * 60 * 60;
        
        var minuten = Math.floor((milli - abgezogen) / 1000 / 60);
        abgezogen = abgezogen + minuten * 1000 * 60; 
        
        var sekunden = Math.floor((milli - abgezogen) / 1000);

        document.getElementById("ferienZähler").innerText = "Das sind : " + wochen + " Wochen, " + tage + " Tage, " + stunden + " Stunden, " + minuten + " Minuten, " + sekunden + "Sekunden, "
        setTimeout(getSecounds, 1000);  
      }

      var select = document.getElementById("ferienAuswahl");

      function selectChange() { 
        ferienDate = Date.parse(_.where(obj, {"slug": select.value})[0].start);
        var ferien = _.where(obj, {"slug": select.value})[0].name;
        document.getElementById("ferienArt").innerHTML = "bis zu den "+ ferien.slice(0, 1).toUpperCase() + ferien.slice(1) + "!";
        getSecounds();
      }

      select.onchange = selectChange;
    </script>
  </body>
</html>  
